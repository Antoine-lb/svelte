var t=Object.defineProperty,e=Object.prototype.hasOwnProperty,o=Object.getOwnPropertySymbols,n=Object.prototype.propertyIsEnumerable,a=(e,o,n)=>o in e?t(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,s=(t,s)=>{for(var r in s||(s={}))e.call(s,r)&&a(t,r,s[r]);if(o)for(var r of o(s))n.call(s,r)&&a(t,r,s[r]);return t};import{O as r,S as l,i as c,s as i,e as d,k as u,c as f,a as h,n as p,d as m,b as v,P as y,f as j,D as g,Q as b,R as w,T as x,U as E,V as O,L as T,t as z,N as M,g as P,W as k,u as _,v as N,r as U,X as D,B as I,Y as R,C as B}from"../../chunks/index-9c400eda.js";import{c as F,s as $}from"../../chunks/index-32bfe71c.js";function S(t,{pending:e,error:o,result:n}){let a;async function s(s){const r=a={};s.preventDefault();const l=new FormData(t);e&&e(l,t);try{const e=await fetch(t.action,{method:t.method,headers:{accept:"application/json"},body:l});if(r!==a)return;e.ok?n(e,t):o?o(e,null,t):console.error(await e.text())}catch(c){if(!o)throw c;o(null,c,t)}}return t.addEventListener("submit",s),{destroy(){t.removeEventListener("submit",s)}}}function C(t,e,o={}){const n=getComputedStyle(t),a="none"===n.transform?"":n.transform,s=e.from.width/t.clientWidth,l=e.from.height/t.clientHeight,c=(e.from.left-e.to.left)/s,i=(e.from.top-e.to.top)/l,d=Math.sqrt(c*c+i*i),{delay:u=0,duration:f=(t=>120*Math.sqrt(t)),easing:h=F}=o;return{delay:u,duration:r(f)?f(d):f,easing:h,css:(t,e)=>`transform: ${a} translate(${e*c}px, ${e*i}px);`}}function L(t,e,o){const n=t.slice();return n[6]=e[o],n}function V(t,e){let o,n,a,s,l,c,i,z,M,P,k,_,N,U,I,R,F,L,V,q,H,W,Q,X,Y,A,G,J=B;function K(...t){return e[3](e[6],...t)}function Z(){return e[4](e[6])}return{key:t,first:null,c(){o=d("div"),n=d("form"),a=d("input"),l=u(),c=d("button"),P=u(),k=d("form"),_=d("input"),U=u(),I=d("button"),F=u(),L=d("form"),V=d("button"),W=u(),this.h()},l(t){o=f(t,"DIV",{class:!0});var e=h(o);n=f(e,"FORM",{action:!0,method:!0});var s=h(n);a=f(s,"INPUT",{type:!0,name:!0,value:!0,class:!0}),l=p(s),c=f(s,"BUTTON",{class:!0,"aria-label":!0}),h(c).forEach(m),s.forEach(m),P=p(e),k=f(e,"FORM",{class:!0,action:!0,method:!0});var r=h(k);_=f(r,"INPUT",{type:!0,name:!0,value:!0,class:!0}),U=p(r),I=f(r,"BUTTON",{class:!0,"aria-label":!0}),h(I).forEach(m),r.forEach(m),F=p(e),L=f(e,"FORM",{action:!0,method:!0});var i=h(L);V=f(i,"BUTTON",{class:!0,"aria-label":!0}),h(V).forEach(m),i.forEach(m),W=p(e),e.forEach(m),this.h()},h(){v(a,"type","hidden"),v(a,"name","done"),a.value=s=e[6].done?"":"true",v(a,"class","svelte-ztcljr"),v(c,"class","toggle svelte-ztcljr"),v(c,"aria-label",i="Mark todo as "+(e[6].done?"not done":"done")),v(n,"action",z="/todos/"+e[6].uid+".json?_method=patch"),v(n,"method","post"),v(_,"type","text"),v(_,"name","text"),_.value=N=e[6].text,v(_,"class","svelte-ztcljr"),v(I,"class","save svelte-ztcljr"),v(I,"aria-label","Save todo"),v(k,"class","text svelte-ztcljr"),v(k,"action",R="/todos/"+e[6].uid+".json?_method=patch"),v(k,"method","post"),v(V,"class","delete svelte-ztcljr"),v(V,"aria-label","Delete todo"),v(L,"action",q="/todos/"+e[6].uid+".json?_method=delete"),v(L,"method","post"),v(o,"class","todo svelte-ztcljr"),y(o,"done",e[6].done),this.first=o},m(t,s){j(t,o,s),g(o,n),g(n,a),g(n,l),g(n,c),g(o,P),g(o,k),g(k,_),g(k,U),g(k,I),g(o,F),g(o,L),g(L,V),g(o,W),Y=!0,A||(G=[b(M=S.call(null,n,{pending:K,result:e[1]})),b(S.call(null,k,{result:e[1]})),b(H=S.call(null,L,{result:Z}))],A=!0)},p(t,l){e=t,(!Y||1&l&&s!==(s=e[6].done?"":"true"))&&(a.value=s),(!Y||1&l&&i!==(i="Mark todo as "+(e[6].done?"not done":"done")))&&v(c,"aria-label",i),(!Y||1&l&&z!==(z="/todos/"+e[6].uid+".json?_method=patch"))&&v(n,"action",z),M&&r(M.update)&&1&l&&M.update.call(null,{pending:K,result:e[1]}),(!Y||1&l&&N!==(N=e[6].text)&&_.value!==N)&&(_.value=N),(!Y||1&l&&R!==(R="/todos/"+e[6].uid+".json?_method=patch"))&&v(k,"action",R),(!Y||1&l&&q!==(q="/todos/"+e[6].uid+".json?_method=delete"))&&v(L,"action",q),H&&r(H.update)&&1&l&&H.update.call(null,{result:Z}),1&l&&y(o,"done",e[6].done)},r(){X=o.getBoundingClientRect()},f(){w(o),J(),x(o,X)},a(){J(),J=E(o,X,C,{duration:200})},i(t){Y||(t&&D((()=>{Q||(Q=O(o,$,{start:.7},!0)),Q.run(1)})),Y=!0)},o(t){t&&(Q||(Q=O(o,$,{start:.7},!1)),Q.run(0)),Y=!1},d(t){t&&m(o),t&&Q&&Q.end(),A=!1,T(G)}}}function q(t){let e,o,n,a,s,l,c,i,y,w,x,E,O=[],T=new Map,D=t[0];const B=t=>t[6].uid;for(let r=0;r<D.length;r+=1){let e=L(t,D,r),o=B(e);T.set(o,O[r]=V(o,e))}return{c(){e=u(),o=d("div"),n=d("h1"),a=z("Todos"),s=u(),l=d("form"),c=d("input"),y=u();for(let t=0;t<O.length;t+=1)O[t].c();this.h()},l(t){M('[data-svelte="svelte-181o7gf"]',document.head).forEach(m),e=p(t),o=f(t,"DIV",{class:!0});var r=h(o);n=f(r,"H1",{});var i=h(n);a=P(i,"Todos"),i.forEach(m),s=p(r),l=f(r,"FORM",{class:!0,action:!0,method:!0});var d=h(l);c=f(d,"INPUT",{name:!0,placeholder:!0,class:!0}),d.forEach(m),y=p(r);for(let e=0;e<O.length;e+=1)O[e].l(r);r.forEach(m),this.h()},h(){document.title="Todos",v(c,"name","text"),v(c,"placeholder","+ tap to add a todo"),v(c,"class","svelte-ztcljr"),v(l,"class","new svelte-ztcljr"),v(l,"action","/todos.json"),v(l,"method","post"),v(o,"class","todos svelte-ztcljr")},m(r,d){j(r,e,d),j(r,o,d),g(o,n),g(n,a),g(o,s),g(o,l),g(l,c),g(o,y);for(let t=0;t<O.length;t+=1)O[t].m(o,null);w=!0,x||(E=b(i=S.call(null,l,{result:t[2]})),x=!0)},p(t,[e]){if(i&&r(i.update)&&1&e&&i.update.call(null,{result:t[2]}),3&e){D=t[0],I();for(let t=0;t<O.length;t+=1)O[t].r();O=k(O,e,B,1,t,D,T,o,R,V,null,L);for(let t=0;t<O.length;t+=1)O[t].a();_()}},i(t){if(!w){for(let t=0;t<D.length;t+=1)N(O[t]);w=!0}},o(t){for(let e=0;e<O.length;e+=1)U(O[e]);w=!1},d(t){t&&m(e),t&&m(o);for(let e=0;e<O.length;e+=1)O[e].d();x=!1,E()}}}var H=function(t,e,o,n){return new(o||(o=Promise))((function(a,s){function r(t){try{c(n.next(t))}catch(e){s(e)}}function l(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,l)}c((n=n.apply(t,e||[])).next())}))};const W=({fetch:t})=>H(void 0,void 0,void 0,(function*(){const e=yield t("/todos.json");if(e.ok){return{props:{todos:yield e.json()}}}const{message:o}=yield e.json();return{error:new Error(o)}}));function Q(t,e,o){var n=this&&this.__awaiter||function(t,e,o,n){return new(o||(o=Promise))((function(a,s){function r(t){try{c(n.next(t))}catch(e){s(e)}}function l(t){try{c(n.throw(t))}catch(e){s(e)}}function c(t){var e;t.done?a(t.value):(e=t.value,e instanceof o?e:new o((function(t){t(e)}))).then(r,l)}c((n=n.apply(t,e||[])).next())}))};let{todos:a}=e;return t.$$set=t=>{"todos"in t&&o(0,a=t.todos)},[a,function(t){return n(this,void 0,void 0,(function*(){const e=yield t.json();o(0,a=a.map((t=>t.uid===e.uid?e:t)))}))},async(t,e)=>{const n=await t.json();o(0,a=[...a,n]),e.reset()},(t,e)=>{const n=!!e.get("done");o(0,a=a.map((e=>e===t?s(s({},e),{done:n}):e)))},t=>{o(0,a=a.filter((e=>e.uid!==t.uid)))}]}export default class extends l{constructor(t){super(),c(this,t,Q,q,i,{todos:0})}}export{W as load};
